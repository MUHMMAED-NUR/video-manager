<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Ù…Ø¯ÙŠØ± Ø±ÙˆØ§Ø¨Ø· Ø§Ù„ÙÙŠØ¯ÙŠÙˆ â€” Ù…ØªØ²Ø§Ù…Ù†</title>
<style>
/* ğŸ¨ ØªÙ†Ø³ÙŠÙ‚ CSS Ù…Ø­Ø³Ù† Ù„ÙŠÙƒÙˆÙ† Ø£ÙƒØ«Ø± Ø§Ø­ØªØ±Ø§ÙÙŠØ© ÙˆÙˆØ¶ÙˆØ­Ø§Ù‹ */
:root{--bg:#f8f9fa;--card:#ffffff;--accent:#007bff;--note:#e9ecef;--text:#212529;--color-rec:#28a745;--color-rej:#dc3545;--light-rec:#d4edda;--light-rej:#f8d7da}
body{font-family: 'Arial', sans-serif;margin:0;padding:25px;background:var(--bg);color:var(--text);display:flex;flex-direction:column;align-items:center}
.header{display:flex;justify-content:flex-end;gap:15px;align-items:center;width:100%;max-width:1400px;margin-bottom:20px}
.btn{background:var(--accent);color:#fff;border:none;padding:10px 18px;border-radius:10px;cursor:pointer;transition:all 0.3s ease;font-weight:bold;box-shadow:0 2px 5px rgba(0,0,0,.1)}
.btn:hover{background:#0056b3;transform:translateY(-1px);box-shadow:0 4px 8px rgba(0,0,0,.2)}
.container{background:var(--card);padding:25px;border-radius:15px;margin-top:20px;box-shadow:0 10px 30px rgba(0,0,0,.08);width:100%;max-width:1400px;border:1px solid #dee2e6}
h2{font-size: 32px; margin-bottom: 25px; color: #343a40; text-align: center;}
.section-title{font-size:26px;margin-bottom:15px;font-weight:700;border-bottom:2px solid #007bff;padding-bottom:5px;color:var(--accent)}
.input-row{display:flex;gap:10px;margin-bottom:20px}
.input-row input, .input-row textarea{flex:1;padding:12px;border:1px solid #ced4da;border-radius:8px;box-shadow:inset 0 1px 3px rgba(0,0,0,.05);transition:border-color 0.3s}
.input-row input:focus, .input-row textarea:focus{border-color:var(--accent);outline:none}
.video-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(450px,1fr));gap:20px}
.video-card{
    background:var(--card);
    padding:15px;
    padding-top: 50px;
    border-radius:12px;
    display:flex;
    gap:15px;
    align-items:center;
    position:relative;
    transition: all 0.3s ease;
    border: 1px solid #ddd;
    box-shadow: 0 4px 12px rgba(0,0,0,.05);
}
.video-card-status-recorded{background: var(--light-rec);border: 2px solid var(--color-rec);}
.video-card-status-rejected{background: var(--light-rej);border: 2px solid var(--color-rej);}
.video-card img{width:190px;height:107px;object-fit:cover;border-radius:8px;border:1px solid #ccc}
.note-box{background:var(--note);padding:8px;border-radius:8px;margin-top:8px;font-size:14px;color:#495057;min-height: 20px;}
.play-btn{display:inline-flex;align-items:center;gap:8px;padding:8px 15px;border-radius:8px;border:1px solid #007bff;background:#f0f7ff;cursor:pointer;text-decoration:none;color:#007bff;margin-top:10px;font-weight:600}
.play-btn:hover{background:#e2f0ff}
.play-icon{width:0;height:0;border-top:8px solid transparent;border-bottom:8px solid transparent;border-left:14px solid #007bff}
.status-label{
    position:absolute;top:0;left:0;right:0;width: 100%;padding:10px 10px;border-radius:12px 12px 0 0; 
    font-size: 16px;font-weight:700;display:none;z-index: 10;text-align: center; box-sizing: border-box; 
    border-bottom: 1px solid transparent; 
}
.status-recorded{background:#c3e6cb;color:var(--color-rec);border-color: var(--color-rec);display:block}
.status-rejected{background:#f5c6cb;color:var(--color-rej);border-color: var(--color-rej);display:block}
.status-controls{display:flex;flex-direction:column;gap:8px;margin-right: auto;}
.status-controls button{padding:10px 15px;border-radius:8px;border:none;color:#fff;font-weight:bold;cursor:pointer;transition: background-color 0.3s ease, transform 0.1s;}
.status-controls .btn-rec{background:var(--color-rec);}
.status-controls .btn-rej{background:var(--color-rej);}
.status-controls button:hover{opacity: 0.9;transform: translateY(-1px);}
.delete-btn{position:absolute;top:8px;right:8px;background:#ff3b3b;color:#fff;border:none;border-radius:6px;padding:6px 10px;cursor:pointer;transition:background-color 0.3s ease}
.delete-btn:hover{background:#cc0000}
.small-note{
    font-size:16px; font-weight: 500; color:#495057; margin-top: 5px; display: block; 
}
.night{background:#1a1a1a;color:#eee}
.night .container{background:#282828}
.night .video-card{background:#3a3a3a;border-color:#444;box-shadow:0 4px 12px rgba(0,0,0,.4)}
.night .note-box{background:#444;color:#eee}
.night .input-row input{background:#3a3a3a;color:#eee;border:1px solid #555}
.night .input-row input:focus{border-color:#007bff}
.night .small-note{color:#bbb;}
.night .section-title{border-bottom-color:#007bff;color:#fff}
.night .play-btn{background:#111;color:#007bff;border-color:#007bff}
#textIdeaList{list-style:none;padding:0;margin-top:10px;}
#textIdeaList li{border-bottom:1px solid #eee;padding:12px 0;display:flex;justify-content:space-between;align-items:center;transition:background-color 0.3s}
.night #textIdeaList li{border-bottom:1px solid #444;}
#password-overlay {
    position: fixed; top: 0; left: 0; width: 100%; height: 100%; 
    background: rgba(0, 0, 0, 0.9); z-index: 1000; 
    display: flex; justify-content: center; align-items: center; 
    flex-direction: column; color: white;
}
#password-box {
    background: #333; padding: 30px; border-radius: 15px; text-align: center;
    box-shadow: 0 0 20px rgba(0, 0, 0, 0.5);
}
#password-box input {
    padding: 10px; margin: 15px 0; border-radius: 8px; border: 1px solid #007bff;
    width: 200px; font-size: 16px; text-align: center;
}
</style>

<!-- ğŸš€ ØªØ¶Ù…ÙŠÙ† Firebase SDK -->
<script src="https://www.gstatic.com/firebasejs/8.6.8/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.6.8/firebase-database.js"></script>

</head>
<body>

<!-- ğŸ” Ø´Ø§Ø´Ø© ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± -->
<div id="password-overlay">
    <div id="password-box">
        <h2>Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±</h2>
        <input type="password" id="passwordInput" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±">
        <button class="btn" onclick="checkPassword()">Ø¯Ø®ÙˆÙ„</button>
        <p id="error-message" style="color: #ff4d4d; margin-top: 10px;"></p>
    </div>
</div>

<!-- Ù…Ø­ØªÙˆÙ‰ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ ÙŠØ¸Ù‡Ø± Ø¨Ø¹Ø¯ Ø§Ù„Ø¯Ø®ÙˆÙ„ -->
<div id="app-content" style="display: none; flex-direction: column; align-items: center; width: 100%;">
    <div class="header">
      <label class="small-note">ÙˆØ¶Ø¹ Ù„ÙŠÙ„ÙŠ</label>
      <button class="btn" onclick="toggleNight()">ØªØ¨Ø¯ÙŠÙ„ Ø§Ù„Ù„ÙŠÙ„</button>
    </div>
    
    <h2>ğŸ“ Ù…Ø¯ÙŠØ± Ø­ÙØ¸ Ø±ÙˆØ§Ø¨Ø· Ø§Ù„ÙÙŠØ¯ÙŠÙˆ â€” Ù…ØªØ²Ø§Ù…Ù† (Firebase)</h2>
    
    <div class="container">
      <div class="section-title">ğŸ¥ Ø§Ù„ÙÙŠØ¯ÙŠÙˆÙ‡Ø§Øª Ø§Ù„Ø·ÙˆÙŠÙ„Ø©</div>
      <div class="input-row">
        <button class="btn" onclick="saveVideo('long')">Ø­ÙØ¸</button>
        <input id="longLink" placeholder="Ø£Ù„ØµÙ‚ Ø±Ø§Ø¨Ø· Ø§Ù„ÙÙŠØ¯ÙŠÙˆ Ù‡Ù†Ø§">
        <input id="longNote" placeholder="Ù…Ù„Ø§Ø­Ø¸Ø© (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)">
      </div>
      <div id="longList" class="video-grid"></div>
    </div>
    
    <div class="container">
      <div class="section-title">ğŸ¬ Ø§Ù„ÙÙŠØ¯ÙŠÙˆÙ‡Ø§Øª Ø§Ù„Ù‚ØµÙŠØ±Ø©</div>
    
      <div class="small-note">ğŸŸ£ Ø±Ø¯Ø© ÙØ¹Ù„</div>
      <div class="input-row">
        <button class="btn" onclick="saveVideo('react')">Ø­ÙØ¸</button>
        <input id="shortReact" placeholder="Ø±Ø§Ø¨Ø· ÙÙŠØ¯ÙŠÙˆ Ø±Ø¯Ø© ÙØ¹Ù„">
        <input id="shortReactNote" placeholder="Ù…Ù„Ø§Ø­Ø¸Ø© (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)">
      </div>
      <div id="reactList" class="video-grid"></div>
    
      <div class="small-note">ğŸŸ¢ ØªÙ…Ø«ÙŠÙ„</div>
      <div class="input-row">
        <button class="btn" onclick="saveVideo('act')">Ø­ÙØ¸</button>
        <input id="shortAct" placeholder="Ø±Ø§Ø¨Ø· ÙÙŠØ¯ÙŠÙˆ ØªÙ…Ø«ÙŠÙ„">
        <input id="shortActNote" placeholder="Ù…Ù„Ø§Ø­Ø¸Ø© (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)">
      </div>
      <div id="actList" class="video-grid"></div>
    
      <div class="small-note">ğŸ”µ ÙÙƒØ±Ø©</div>
      <div class="input-row">
        <button class="btn" onclick="saveVideo('idea')">Ø­ÙØ¸</button>
        <input id="shortIdea" placeholder="Ø±Ø§Ø¨Ø· ÙÙŠØ¯ÙŠÙˆ ÙÙƒØ±Ø©">
        <input id="shortIdeaNote" placeholder="Ù…Ù„Ø§Ø­Ø¸Ø© (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)">
      </div>
      <div id="ideaList" class="video-grid"></div>
    </div>
    
    <div class="container">
      <div class="section-title">ğŸ“ Ø£ÙÙƒØ§Ø± Ù†ØµÙŠØ©</div>
      <div class="input-row">
        <input id="textIdea" placeholder="Ø§ÙƒØªØ¨ ÙÙƒØ±Ø© Ù‡Ù†Ø§">
        <button class="btn" onclick="saveTextIdea()">Ø­ÙØ¸</button>
      </div>
      <ul id="textIdeaList"></ul>
    </div>
</div>

<script>
// ==============================================
// 1. Ø¥Ø¹Ø¯Ø§Ø¯ Firebase
// ==============================================

const firebaseConfig = {
    apiKey: "AIzaSyA4GCJfuEBCoiaD2h3BSiZzAq4vK2wTVPE",
    authDomain: "videomanagerapp-bdcbf.firebaseapp.com",
    databaseURL: "https://videomanagerapp-bdcbf-default-rtdb.europe-west1.firebasedatabase.app", 
    projectId: "videomanagerapp-bdcbf",
    storageBucket: "videomanagerapp-bdcbf.firebasestorage.app",
    messagingSenderId: "505800131782",
    appId: "1:505800131782:web:0351d4f2642c40376983c7",
    measurementId: "G-N6VJBGS11F"
};

// ØªÙ‡ÙŠØ¦Ø© Firebase ÙˆØªØ¹ÙŠÙŠÙ† Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„ÙˆØµÙˆÙ„
firebase.initializeApp(firebaseConfig);
const db = firebase.database();
// Ø§Ù„Ù…Ø³Ø§Ø± Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ Ù„Ù„Ø¨ÙŠØ§Ù†Ø§Øª
const dbRef = db.ref('user_data'); 

let allData = {long: [], react: [], act: [], idea: []}; 
let textIdeas = []; 

// ==============================================
// 2. Ø¯ÙˆØ§Ù„ Ø§Ù„ØªØ­Ù‚Ù‚ ÙˆØ§Ù„Ø­Ù…Ø§ÙŠØ©
// ==============================================

const CORRECT_PASSWORD = "963507"; 

function showCustomMessage(message, isError = false) {
    const errorEl = document.getElementById('error-message');
    if (errorEl) {
        // Ø¥Ø°Ø§ ÙƒÙ†Ø§ Ø¹Ù„Ù‰ Ø´Ø§Ø´Ø© Ø§Ù„Ø¯Ø®ÙˆÙ„ØŒ Ù†Ø¹Ø±Ø¶ Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ù‡Ù†Ø§Ùƒ
        errorEl.textContent = message;
        errorEl.style.color = isError ? '#ff4d4d' : '#fff';
    } else {
        // Ø¥Ø°Ø§ ÙƒÙ†Ø§ Ø¯Ø§Ø®Ù„ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ØŒ Ù†Ø³ØªØ®Ø¯Ù… console.log
        console.log(isError ? "Error: " + message : "Message: " + message);
    }
}

function checkPassword() {
    const inputPasswordEl = document.getElementById('passwordInput');
    const inputPassword = inputPasswordEl.value.trim();

    if (inputPassword === CORRECT_PASSWORD) {
        document.getElementById('password-overlay').style.display = 'none';
        document.getElementById('app-content').style.display = 'flex';
        // ğŸš€ Ø§Ù„Ø¨Ø¯Ø¡ Ø¨ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† Firebase ÙÙ‚Ø· Ø¨Ø¹Ø¯ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø§Ù„Ù†Ø§Ø¬Ø­
        initFirebaseSync(); 
    } else {
        showCustomMessage("ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ØºÙŠØ± ØµØ­ÙŠØ­Ø©. Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.", true);
        inputPasswordEl.value = '';
    }
}

// ==============================================
// 3. Ø¯ÙˆØ§Ù„ Ø§Ù„ØªØ®Ø²ÙŠÙ† ÙˆØ§Ù„Ø­ÙØ¸ ÙˆØ§Ù„ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ (Real-time)
// ==============================================

// Ù‡Ø°Ù‡ Ø§Ù„Ø¯Ø§Ù„Ø© Ù‡ÙŠ Ø§Ù„ÙˆØ­ÙŠØ¯Ø© Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„Ø© Ø¹Ù† ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† Firebase
function dataReceived(snapshot) {
    const data = snapshot.val();
    
    // 1. ØªØ­Ø¯ÙŠØ« Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ÙÙŠØ¯ÙŠÙˆÙ‡Ø§Øª
    if (data && data.videos) {
        // Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† Ø£Ù† Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù‡ÙŠ Ù…ØµÙÙˆÙØ§Øª Ù†Ø¸ÙŠÙØ©
        allData = Object.keys(data.videos).reduce((acc, key) => {
            acc[key] = data.videos[key] ? (Array.isArray(data.videos[key]) ? data.videos[key].filter(Boolean) : Object.values(data.videos[key]).filter(Boolean)) : [];
            return acc;
        }, {long: [], react: [], act: [], idea: []});
    } else {
        allData = {long: [], react: [], act: [], idea: []};
    }
    
    // 2. ØªØ­Ø¯ÙŠØ« Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£ÙÙƒØ§Ø± Ø§Ù„Ù†ØµÙŠØ©
    if (data && data.ideas) {
         // Ø§Ù„ØªØ¹Ø§Ù…Ù„ Ù…Ø¹ Ø§Ù„Ø£ÙÙƒØ§Ø± Ø§Ù„Ù†ØµÙŠØ© ÙƒÙ‚Ø§Ø¦Ù…Ø©
        textIdeas = Array.isArray(data.ideas) ? data.ideas.filter(Boolean) : Object.values(data.ideas).filter(v => typeof v === 'string');
    } else {
        textIdeas = [];
    }

    // 3. Ø¥Ø¹Ø§Ø¯Ø© Ø±Ø³Ù… Ø§Ù„ÙˆØ§Ø¬Ù‡Ø© Ø¨Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©
    renderAll();
    console.log("âœ… ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„ÙˆØ§Ø¬Ù‡Ø© Ø¨Ù†Ø¬Ø§Ø­ Ù…Ù† Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª.");
}

// Ù‡Ø°Ù‡ Ø§Ù„Ø¯Ø§Ù„Ø© Ù‡ÙŠ Ø§Ù„ÙˆØ­ÙŠØ¯Ø© Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„Ø© Ø¹Ù† Ø§Ù„Ø­ÙØ¸ ÙÙŠ Firebase
function saveAllToFirebase() {
    // Ø¨Ù†Ø§Ø¡ ÙƒØ§Ø¦Ù† Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ù„Ø­ÙØ¸
    const dataToSave = {
        videos: Object.keys(allData).reduce((acc, key) => {
            acc[key] = allData[key].filter(Boolean);
            return acc;
        }, {}),
        ideas: textIdeas.filter(Boolean)
    };
    
    // Ø§Ø³ØªØ®Ø¯Ø§Ù… set Ù„Ø­ÙØ¸ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙÙŠ Ø§Ù„Ù…Ø³Ø§Ø± Ø§Ù„Ù…Ø­Ø¯Ø¯ (ÙˆÙ‡Ùˆ Ù…Ø§ ÙŠØ³Ø¨Ø¨ Ø§Ù„Ù…Ø²Ø§Ù…Ù†Ø©)
    dbRef.set(dataToSave).catch(error => {
        console.error("Error saving data to Firebase:", error);
        showCustomMessage("âŒ ÙØ´Ù„ ÙÙŠ Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª. ØªØ£ÙƒØ¯ Ø£Ù† Ù‚ÙˆØ§Ø¹Ø¯ Ø§Ù„Ø£Ù…Ø§Ù† ØªØ³Ù…Ø­ Ø¨Ø§Ù„ÙƒØªØ§Ø¨Ø©.", true);
    });
}

function initFirebaseSync() {
    // ğŸš¨ ØªÙØ¹ÙŠÙ„ Ø§Ù„Ø§Ø³ØªÙ…Ø§Ø¹ ÙÙŠ Ø§Ù„ÙˆÙ‚Øª Ø§Ù„ÙØ¹Ù„ÙŠ ğŸš¨
    dbRef.on('value', dataReceived, (error) => {
        console.error("Firebase Read Error:", error);
        showCustomMessage("Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª. Ø±Ø§Ø¬Ø¹ Ø§Ù„ÙƒÙˆÙ†Ø³Ù„.", true);
    });

    // ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ù„ÙŠÙ„ÙŠ
    if (localStorage.getItem('nightMode') === 'true') {
        document.body.classList.add('night');
    }
}

// Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø­Ø¯Ø« Ù„Ø¶ØºØ· Ù…ÙØªØ§Ø­ Enter ÙÙŠ Ø­Ù‚Ù„ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±
document.addEventListener('DOMContentLoaded', () => {
    const passwordInput = document.getElementById('passwordInput');
    if (passwordInput) {
        passwordInput.addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                checkPassword();
            }
        });
    }
});


// ==============================================
// 4. Ø¨Ù‚ÙŠØ© Ø§Ù„Ø¯ÙˆØ§Ù„ (Ø¨Ø¯ÙˆÙ† ØªØ¹Ø¯ÙŠÙ„ Ø¬ÙˆÙ‡Ø±ÙŠ)
// ==============================================

// --- Helpers ---
function extractVideoId(url){
  const patterns=[/v=([^&]+)/,/youtu.be\/([^?&]+)/,/embed\/([^?&]+)/,/shorts\/([^?&]+)/];
  for(const p of patterns){const m=url.match(p); if(m) return m[1];}
  return null;
}
async function fetchVideoData(videoId){
  try{const res=await fetch(`https://noembed.com/embed?url=https://www.youtube.com/watch?v=${videoId}`); if(!res.ok) return null; return await res.json();}catch{return null}
}
function genId(){return 'v_'+Date.now()+'_'+Math.floor(Math.random()*1000)}


// --- Render ---
function renderCard(video,type){
  const container=document.getElementById(type+'List');
  const existingCard = document.querySelector(`#${type}List > .video-card[data-id="${video.id}"]`);
  if (existingCard) return; 

  const card=document.createElement('div');
  card.className='video-card';
  card.setAttribute('data-id',video.id);

  if(video.recorded) {
    card.classList.add('video-card-status-recorded');
  } else if(video.rejected) {
    card.classList.add('video-card-status-rejected');
  }

  const del=document.createElement('button');
  del.className='delete-btn';
  del.textContent='X';
  del.onclick=()=>deleteVideo(video.id);
  card.appendChild(del);

  const statusLabel=document.createElement('div');
  statusLabel.className='status-label';
  if(video.rejected){statusLabel.classList.add('status-rejected'); statusLabel.textContent='Ù…Ø±ÙÙˆØ¶'}
  else if(video.recorded){statusLabel.classList.add('status-recorded'); statusLabel.textContent='ØªÙ… Ø§Ù„ØªØµÙˆÙŠØ±'}
  card.appendChild(statusLabel);

  const img=document.createElement('img'); 
  img.src=video.thumbnail;
  img.onerror = function() { this.src = 'https://placehold.co/190x107/cccccc/000000?text=No+Image'; }; 
  
  const info=document.createElement('div');
  info.innerHTML=`<h4 style="margin:0 0 6px; font-size: 16px;">${video.title}</h4>
    <div class='note-box'>${video.note||'Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ù„Ø§Ø­Ø¸Ø©'}</div>
    <div style='margin-top:8px'><a class='play-btn' href='${video.url}' target='_blank'><span class='play-icon'></span><span>ØªØ´ØºÙŠÙ„ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ</span></a></div>`;

  const controls=document.createElement('div'); controls.className='status-controls';
  const btnRec=document.createElement('button'); btnRec.className='btn-rec'; btnRec.textContent='âœ“ ØªØµÙˆÙŠØ±'; btnRec.onclick=()=>toggleRecorded(video.id);
  const btnRej=document.createElement('button'); btnRej.className='btn-rej'; btnRej.textContent='âœ• Ø±ÙØ¶'; btnRej.onclick=()=>toggleRejected(video.id);
  controls.appendChild(btnRec); controls.appendChild(btnRej);

  card.appendChild(img); card.appendChild(info); card.appendChild(controls);
  container.appendChild(card);
}

function clearAllRender(){
    ['long','react','act','idea'].forEach(t=>document.getElementById(t+'List').innerHTML='')
}

function renderAll(){
    clearAllRender(); 
    for(const t of Object.keys(allData)){
        if (Array.isArray(allData[t])) {
            // ÙŠØªÙ… Ø¹Ø±Ø¶ Ø§Ù„ÙÙŠØ¯ÙŠÙˆÙ‡Ø§Øª Ø¨ØªØ±ØªÙŠØ¨ Ø¹ÙƒØ³ÙŠ (Ø§Ù„Ø£Ø­Ø¯Ø« Ø£ÙˆÙ„Ø§Ù‹)
            [...allData[t]].reverse().forEach(v=>renderCard(v,t));
        }
    } 
    renderTextIdeas();
}

// --- Save video ---
async function saveVideo(type){
  let linkId, noteId;
  if (type === 'long') {
    linkId = 'longLink';
    noteId = 'longNote';
  } else if (type === 'react') {
    linkId = 'shortReact';
    noteId = 'shortReactNote';
  } else if (type === 'act') {
    linkId = 'shortAct';
    noteId = 'shortActNote';
  } else if (type === 'idea') {
    linkId = 'shortIdea';
    noteId = 'shortIdeaNote';
  } else {
    return;
  }
  
  const linkEl = document.getElementById(linkId);
  const noteEl = document.getElementById(noteId);
  const link = linkEl.value.trim();
  const note = noteEl.value.trim();
  
  if (!link) {
    // Ù†Ø³ØªØ®Ø¯Ù… showCustomMessage Ù‡Ù†Ø§
    console.error('Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø±Ø§Ø¨Ø· ÙÙŠØ¯ÙŠÙˆ.'); 
    return;
  }
  
  const videoId = extractVideoId(link);
  if (!videoId) {
    console.error('Ø§Ù„Ø±Ø§Ø¨Ø· ØºÙŠØ± ØµØ§Ù„Ø­. Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† Ø£Ù†Ù‡ Ø±Ø§Ø¨Ø· ÙŠÙˆØªÙŠÙˆØ¨ ØµØ­ÙŠØ­.');
    return;
  }
  
  console.log('ÙŠØªÙ… Ø¬Ù„Ø¨ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ÙÙŠØ¯ÙŠÙˆ...');

  const videoData = await fetchVideoData(videoId);
  if (!videoData || videoData.error) {
    console.error('ØªØ¹Ø°Ø± Ø¬Ù„Ø¨ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ÙÙŠØ¯ÙŠÙˆ. Ø±Ø¨Ù…Ø§ Ø§Ù„Ø±Ø§Ø¨Ø· ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯ Ø£Ùˆ Ø®Ø§Øµ.');
    return;
  }
  
  const newVideo = {
    id: genId(),
    type: type,
    url: link,
    videoId: videoId,
    title: videoData.title || 'ÙÙŠØ¯ÙŠÙˆ ØºÙŠØ± Ù…Ø¹Ù†ÙˆÙ†',
    thumbnail: videoData.thumbnail_url || 'https://placehold.co/190x107/cccccc/000000?text=No+Image',
    note: note,
    recorded: false,
    rejected: false
  };
  
  if (!allData[type]) {
    allData[type] = [];
  }
  allData[type].push(newVideo);
  
  // ğŸ”‘ Ù‡Ø°Ø§ Ù‡Ùˆ Ø§Ù„Ù…ÙØªØ§Ø­: ÙŠØªÙ… Ø§Ù„Ø­ÙØ¸ ÙÙŠ Firebase
  saveAllToFirebase(); 
  linkEl.value = '';
  noteEl.value = '';
}

// --- Text Ideas Logic ---

function renderTextIdeas() {
  const ul = document.getElementById('textIdeaList');
  ul.innerHTML = '';
  
  const ideasToRender = [...textIdeas].filter(Boolean).reverse();

  ideasToRender.forEach((idea, index) => {
    const originalIndex = textIdeas.length - 1 - index; 

    const li = document.createElement('li');

    const textSpan = document.createElement('span');
    textSpan.textContent = idea;
    
    const delBtn = document.createElement('button');
    delBtn.textContent = 'Ø­Ø°Ù';
    delBtn.style.cssText = `
        background: #dc3545;
        color: #fff;
        border: none;
        border-radius: 6px;
        padding: 6px 10px;
        cursor: pointer;
        transition: background-color 0.3s ease;
    `;
    delBtn.onmouseover = () => delBtn.style.backgroundColor = '#c82333';
    delBtn.onmouseout = () => delBtn.style.backgroundColor = '#dc3545';

    delBtn.onclick = () => deleteTextIdea(originalIndex);
    
    li.appendChild(textSpan);
    li.appendChild(delBtn);
    ul.appendChild(li);
  });
}

function saveTextIdea() {
  const inputEl = document.getElementById('textIdea');
  const idea = inputEl.value.trim();
  
  if (idea) {
    textIdeas.push(idea);
    
    // ğŸ”‘ Ù‡Ø°Ø§ Ù‡Ùˆ Ø§Ù„Ù…ÙØªØ§Ø­: ÙŠØªÙ… Ø§Ù„Ø­ÙØ¸ ÙÙŠ Firebase
    saveAllToFirebase(); 
    inputEl.value = '';
  } else {
    console.error('Ø§Ù„Ø±Ø¬Ø§Ø¡ ÙƒØªØ§Ø¨Ø© ÙÙƒØ±Ø© Ù†ØµÙŠØ© Ù„Ø­ÙØ¸Ù‡Ø§.');
  }
}

function deleteTextIdea(index) {
  if (index >= 0 && index < textIdeas.length) {
    textIdeas.splice(index, 1);
    // ğŸ”‘ Ù‡Ø°Ø§ Ù‡Ùˆ Ø§Ù„Ù…ÙØªØ§Ø­: ÙŠØªÙ… Ø§Ù„Ø­ÙØ¸ ÙÙŠ Firebase
    saveAllToFirebase(); 
  }
}


// --- Toggles for Video Status ---

function toggleRecorded(id) {
    for (const type in allData) {
        if (!Array.isArray(allData[type])) continue; 
        const index = allData[type].findIndex(v => v.id === id);
        if (index !== -1) {
            const video = allData[type][index];
            video.recorded = !video.recorded;
            video.rejected = false; 
            // ğŸ”‘ Ù‡Ø°Ø§ Ù‡Ùˆ Ø§Ù„Ù…ÙØªØ§Ø­: ÙŠØªÙ… Ø§Ù„Ø­ÙØ¸ ÙÙŠ Firebase
            saveAllToFirebase(); 
            return;
        }
    }
}

function toggleRejected(id) {
    for (const type in allData) {
        if (!Array.isArray(allData[type])) continue; 
        const index = allData[type].findIndex(v => v.id === id);
        if (index !== -1) {
            const video = allData[type][index];
            video.rejected = !video.rejected;
            video.recorded = false; 
            // ğŸ”‘ Ù‡Ø°Ø§ Ù‡Ùˆ Ø§Ù„Ù…ÙØªØ§Ø­: ÙŠØªÙ… Ø§Ù„Ø­ÙØ¸ ÙÙŠ Firebase
            saveAllToFirebase(); 
            return;
        }
    }
}

function deleteVideo(id) {
    let found = false;
    for (const type in allData) {
        if (!Array.isArray(allData[type])) continue; 
        const initialLength = allData[type].length;
        allData[type] = allData[type].filter(v => v.id !== id);
        if (allData[type].length < initialLength) {
            found = true;
            break;
        }
    }
    if (found) {
        // ğŸ”‘ Ù‡Ø°Ø§ Ù‡Ùˆ Ø§Ù„Ù…ÙØªØ§Ø­: ÙŠØªÙ… Ø§Ù„Ø­ÙØ¸ ÙÙŠ Firebase
        saveAllToFirebase(); 
    }
}

// --- Dark Mode Logic ---

function toggleNight() {
  document.body.classList.toggle('night');
  localStorage.setItem('nightMode', document.body.classList.contains('night'));
}
</script>
</body>
</html>
